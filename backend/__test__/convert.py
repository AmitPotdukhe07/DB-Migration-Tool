import json

data = [
    
    {
      "SCHEMA_NAME": "CRAVE_ACCOUNTS_LIVE",
      "TABLE_NAME": "OITM",
      "TABLE_OID": 582067,
      "COLUMN_NAME": "SLen2Unit",
      "POSITION": 74,
      "DATA_TYPE_ID": 5,
      "DATA_TYPE_NAME": "SMALLINT",
      "OFFSET": 341,
      "LENGTH": 5,
      "SCALE": 0,
      "IS_NULLABLE": "TRUE",
      "DEFAULT_VALUE": None,
      "COLLATION": "",
      "COMMENTS": None,
      "MAX_VALUE": None,
      "MIN_VALUE": None,
      "CS_DATA_TYPE_ID": 73,
      "CS_DATA_TYPE_NAME": "INT",
      "DDIC_DATA_TYPE_ID": 32,
      "DDIC_DATA_TYPE_NAME": "INVALID",
      "COMPRESSION_TYPE": "DEFAULT",
      "INDEX_TYPE": "NONE",
      "COLUMN_ID": 13267315,
      "PRELOAD": "FALSE",
      "GENERATED_ALWAYS_AS": None,
      "HAS_SCHEMA_FLEXIBILITY": "FALSE",
      "FUZZY_SEARCH_INDEX": "FALSE",
      "FUZZY_SEARCH_MODE": None,
      "MEMORY_THRESHOLD": None,
      "LOAD_UNIT": "COLUMN",
      "GENERATION_TYPE": None,
      "IS_CACHABLE": "FALSE",
      "IS_CACHE_KEY": "FALSE",
      "ROW_ORDER_POSITION": None
    },
    {
      "SCHEMA_NAME": "CRAVE_ACCOUNTS_LIVE",
      "TABLE_NAME": "OITM",
      "TABLE_OID": 582067,
      "COLUMN_NAME": "SVolume",
      "POSITION": 75,
      "DATA_TYPE_ID": 3,
      "DATA_TYPE_NAME": "DECIMAL",
      "OFFSET": 344,
      "LENGTH": 21,
      "SCALE": 6,
      "IS_NULLABLE": "TRUE",
      "DEFAULT_VALUE": None,
      "COLLATION": "",
      "COMMENTS": None,
      "MAX_VALUE": None,
      "MIN_VALUE": None,
      "CS_DATA_TYPE_ID": 66,
      "CS_DATA_TYPE_NAME": "FIXED",
      "DDIC_DATA_TYPE_ID": 32,
      "DDIC_DATA_TYPE_NAME": "INVALID",
      "COMPRESSION_TYPE": "DEFAULT",
      "INDEX_TYPE": "NONE",
      "COLUMN_ID": 13267316,
      "PRELOAD": "FALSE",
      "GENERATED_ALWAYS_AS": None,
      "HAS_SCHEMA_FLEXIBILITY": "FALSE",
      "FUZZY_SEARCH_INDEX": "FALSE",
      "FUZZY_SEARCH_MODE": None,
      "MEMORY_THRESHOLD": None,
      "LOAD_UNIT": "COLUMN",
      "GENERATION_TYPE": None,
      "IS_CACHABLE": "FALSE",
      "IS_CACHE_KEY": "FALSE",
      "ROW_ORDER_POSITION": None
    },
    {
      "SCHEMA_NAME": "CRAVE_ACCOUNTS_LIVE",
      "TABLE_NAME": "OITM",
      "TABLE_OID": 582067,
      "COLUMN_NAME": "SVolUnit",
      "POSITION": 76,
      "DATA_TYPE_ID": 5,
      "DATA_TYPE_NAME": "SMALLINT",
      "OFFSET": 354,
      "LENGTH": 5,
      "SCALE": 0,
      "IS_NULLABLE": "TRUE",
      "DEFAULT_VALUE": None,
      "COLLATION": "",
      "COMMENTS": None,
      "MAX_VALUE": None,
      "MIN_VALUE": None,
      "CS_DATA_TYPE_ID": 73,
      "CS_DATA_TYPE_NAME": "INT",
      "DDIC_DATA_TYPE_ID": 32,
      "DDIC_DATA_TYPE_NAME": "INVALID",
      "COMPRESSION_TYPE": "DEFAULT",
      "INDEX_TYPE": "NONE",
      "COLUMN_ID": 13267317,
      "PRELOAD": "FALSE",
      "GENERATED_ALWAYS_AS": None,
      "HAS_SCHEMA_FLEXIBILITY": "FALSE",
      "FUZZY_SEARCH_INDEX": "FALSE",
      "FUZZY_SEARCH_MODE": None,
      "MEMORY_THRESHOLD": None,
      "LOAD_UNIT": "COLUMN",
      "GENERATION_TYPE": None,
      "IS_CACHABLE": "FALSE",
      "IS_CACHE_KEY": "FALSE",
      "ROW_ORDER_POSITION": None
    },
    {
      "SCHEMA_NAME": "CRAVE_ACCOUNTS_LIVE",
      "TABLE_NAME": "OITM",
      "TABLE_OID": 582067,
      "COLUMN_NAME": "SWeight1",
      "POSITION": 77,
      "DATA_TYPE_ID": 3,
      "DATA_TYPE_NAME": "DECIMAL",
      "OFFSET": 357,
      "LENGTH": 21,
      "SCALE": 6,
      "IS_NULLABLE": "TRUE",
      "DEFAULT_VALUE": None,
      "COLLATION": "",
      "COMMENTS": None,
      "MAX_VALUE": None,
      "MIN_VALUE": None,
      "CS_DATA_TYPE_ID": 66,
      "CS_DATA_TYPE_NAME": "FIXED",
      "DDIC_DATA_TYPE_ID": 32,
      "DDIC_DATA_TYPE_NAME": "INVALID",
      "COMPRESSION_TYPE": "DEFAULT",
      "INDEX_TYPE": "NONE",
      "COLUMN_ID": 13267318,
      "PRELOAD": "FALSE",
      "GENERATED_ALWAYS_AS": None,
      "HAS_SCHEMA_FLEXIBILITY": "FALSE",
      "FUZZY_SEARCH_INDEX": "FALSE",
      "FUZZY_SEARCH_MODE": None,
      "MEMORY_THRESHOLD": None,
      "LOAD_UNIT": "COLUMN",
      "GENERATION_TYPE": None,
      "IS_CACHABLE": "FALSE",
      "IS_CACHE_KEY": "FALSE",
      "ROW_ORDER_POSITION": None
    },
    {
      "SCHEMA_NAME": "CRAVE_ACCOUNTS_LIVE",
      "TABLE_NAME": "OITM",
      "TABLE_OID": 582067,
      "COLUMN_NAME": "SWght1Unit",
      "POSITION": 78,
      "DATA_TYPE_ID": 5,
      "DATA_TYPE_NAME": "SMALLINT",
      "OFFSET": 367,
      "LENGTH": 5,
      "SCALE": 0,
      "IS_NULLABLE": "TRUE",
      "DEFAULT_VALUE": None,
      "COLLATION": "",
      "COMMENTS": None,
      "MAX_VALUE": None,
      "MIN_VALUE": None,
      "CS_DATA_TYPE_ID": 73,
      "CS_DATA_TYPE_NAME": "INT",
      "DDIC_DATA_TYPE_ID": 32,
      "DDIC_DATA_TYPE_NAME": "INVALID",
      "COMPRESSION_TYPE": "DEFAULT",
      "INDEX_TYPE": "NONE",
      "COLUMN_ID": 13267319,
      "PRELOAD": "FALSE",
      "GENERATED_ALWAYS_AS": None,
      "HAS_SCHEMA_FLEXIBILITY": "FALSE",
      "FUZZY_SEARCH_INDEX": "FALSE",
      "FUZZY_SEARCH_MODE": None,
      "MEMORY_THRESHOLD": None,
      "LOAD_UNIT": "COLUMN",
      "GENERATION_TYPE": None,
      "IS_CACHABLE": "FALSE",
      "IS_CACHE_KEY": "FALSE",
      "ROW_ORDER_POSITION": None
    },
    {
      "SCHEMA_NAME": "CRAVE_ACCOUNTS_LIVE",
      "TABLE_NAME": "OITM",
      "TABLE_OID": 582067,
      "COLUMN_NAME": "SWeight2",
      "POSITION": 79,
      "DATA_TYPE_ID": 3,
      "DATA_TYPE_NAME": "DECIMAL",
      "OFFSET": 370,
      "LENGTH": 21,
      "SCALE": 6,
      "IS_NULLABLE": "TRUE",
      "DEFAULT_VALUE": None,
      "COLLATION": "",
      "COMMENTS": None,
      "MAX_VALUE": None,
      "MIN_VALUE": None,
      "CS_DATA_TYPE_ID": 66,
      "CS_DATA_TYPE_NAME": "FIXED",
      "DDIC_DATA_TYPE_ID": 32,
      "DDIC_DATA_TYPE_NAME": "INVALID",
      "COMPRESSION_TYPE": "DEFAULT",
      "INDEX_TYPE": "NONE",
      "COLUMN_ID": 13267320,
      "PRELOAD": "FALSE",
      "GENERATED_ALWAYS_AS": None,
      "HAS_SCHEMA_FLEXIBILITY": "FALSE",
      "FUZZY_SEARCH_INDEX": "FALSE",
      "FUZZY_SEARCH_MODE": None,
      "MEMORY_THRESHOLD": None,
      "LOAD_UNIT": "COLUMN",
      "GENERATION_TYPE": None,
      "IS_CACHABLE": "FALSE",
      "IS_CACHE_KEY": "FALSE",
      "ROW_ORDER_POSITION": None
    }

]

def json_to_sql_create_table(json_data):
    schema_name = json_data[0]["SCHEMA_NAME"]
    table_name = json_data[0]["TABLE_NAME"]

    create_table_sql = f"CREATE TABLE {schema_name}.{table_name} (\n"

    column_definitions = []
    for column in json_data:
        column_name = column["COLUMN_NAME"]
        data_type = column["DATA_TYPE_NAME"]
        length = column.get("LENGTH")
        scale = column.get("SCALE")
        is_nullable = column["IS_NULLABLE"] == "TRUE"
        default_value = column.get("DEFAULT_VALUE")

        column_def = f"  {column_name} {data_type}"
        if data_type in ["DECIMAL", "NUMERIC"] and length and scale is not None:
            column_def += f"({length}, {scale})"
        elif length:
            column_def += f"({length})"

        if not is_nullable:
            column_def += " NOT None"

        if default_value is not None:
            column_def += f" DEFAULT {default_value}"

        column_definitions.append(column_def)

    create_table_sql += ",\n".join(column_definitions)
    create_table_sql += "\n);"

    return create_table_sql

sql_statement = json_to_sql_create_table(data)
print(sql_statement)
